 static class DataTransferTask implements Runnable {
        private final ResultSet resultSet;
        private final String tableName;
        private final int rowCount;

        public DataTransferTask(ResultSet resultSet, String tableName, int rowCount) {
            this.resultSet = resultSet;
            this.tableName = tableName;
            this.rowCount = rowCount;
        }

        @Override
        public void run() {
            int insertedRows = 0;
            try (Connection pgConn = pgDataSource.getConnection()) {
                ResultSetMetaData metaData = resultSet.getMetaData();
                int columnCount = metaData.getColumnCount();
                
                StringBuilder insertQuery = new StringBuilder("INSERT INTO " + tableName + " (");
                for (int i = 1; i <= columnCount; i++) {
                    insertQuery.append(metaData.getColumnName(i));
                    if (i < columnCount) insertQuery.append(", ");
                }
                insertQuery.append(") VALUES (");
                insertQuery.append("?, ".repeat(columnCount - 1)).append("?)");
                
                try (PreparedStatement pstmt = pgConn.prepareStatement(insertQuery.toString())) {
                    int count = 0;
                    while (resultSet.next()) {
                        for (int i = 1; i <= columnCount; i++) {
                            pstmt.setObject(i, resultSet.getObject(i));
                        }
                        pstmt.addBatch();
                        count++;
                        insertedRows++;
                        
                        if (count % BATCH_SIZE == 0) {
                            pstmt.executeBatch();
                            pgConn.commit();
                        }
                    }
                    pstmt.executeBatch();
                    pgConn.commit();
                }
            } catch (SQLException e) {
                e.printStackTrace();
            }
            System.out.printf("Table: %s | Rows Inserted: %d/%d\n", tableName, insertedRows, rowCount);
        }
    }
