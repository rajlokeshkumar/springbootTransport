
    private static void fetchAndInsertData(String tableName, int offset) {
        String selectQuery = "SELECT * FROM " + SCHEMA_NAME + "." + tableName + " ORDER BY id LIMIT " + PAGE_SIZE + " OFFSET " + offset;
        
        try (Connection db2Conn = db2DataSource.getConnection();
             Statement stmt = db2Conn.createStatement();
             ResultSet rs = stmt.executeQuery(selectQuery)) {
            
            ResultSetMetaData metaData = rs.getMetaData();
            int columnCount = metaData.getColumnCount();
            StringBuilder insertQuery = new StringBuilder("INSERT INTO " + SCHEMA_NAME + "." + tableName + " (");
            
            for (int i = 1; i <= columnCount; i++) {
                insertQuery.append(metaData.getColumnName(i));
                if (i < columnCount) insertQuery.append(", ");
            }
            insertQuery.append(") VALUES (");
            for (int i = 1; i <= columnCount; i++) {
                insertQuery.append("?");
                if (i < columnCount) insertQuery.append(", ");
            }
            insertQuery.append(")");
            
            try (Connection pgConn = pgDataSource.getConnection();
                 PreparedStatement pstmt = pgConn.prepareStatement(insertQuery.toString())) {
                
                while (rs.next()) {
                    for (int i = 1; i <= columnCount; i++) {
                        pstmt.setObject(i, rs.getObject(i));
                    }
                    pstmt.addBatch();
                }
                pstmt.executeBatch();
                pgConn.commit();
                logger.info("Batch data inserted for table: " + tableName + " at offset: " + offset);
            }
        } catch (SQLException e) {
            logger.error("Error transferring data for table: " + tableName + " at offset: " + offset, e);
        }
    }
    
